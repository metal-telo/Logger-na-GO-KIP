#!/bin/bash

echo "ðŸš€ Ð—Ð°Ð¿ÑƒÑÐº Ð½Ð°Ð³Ñ€ÑƒÐ·Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Employee Management System"
echo "==============================================================="

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²
RESULTS_DIR="load-test-results"
mkdir -p $RESULTS_DIR
BASE_URL="http://localhost:8080/api"

# Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ñ‚ÐµÑÑ‚Ð°
run_test() {
    local test_name=$1
    local endpoint=$2
    local method=$3
    local body=$4
    local connections=$5
    local duration=$6
    local description=$7
    
    echo ""
    echo "ðŸ“Š Ð¢ÐµÑÑ‚: $test_name"
    echo "   ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ: $description"
    echo "   ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹: $connections ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹, ${duration}ÑÐµÐº"
    
    # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ñ‚ÐµÐ»Ð° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾
    local body_file=""
    if [ -n "$body" ]; then
        body_file="/tmp/plow_body_${test_name}.json"
        echo "$body" > $body_file
    fi
    
    if [ "$method" = "POST" ] && [ -n "$body" ]; then
        plow -c $connections -d ${duration}s -T "application/json" --body "$body" -m $method $BASE_URL$endpoint > $RESULTS_DIR/${test_name}.log 2>&1
    else
        plow -c $connections -d ${duration}s -m $method $BASE_URL$endpoint > $RESULTS_DIR/${test_name}.log 2>&1
    fi
    
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ÑÑ‚ÑŒ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ
    if [ $? -eq 0 ]; then
        echo "   âœ… Ð£ÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½"
    else
        echo "   âŒ Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½ Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ð¼Ð¸"
    fi
    
    # ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹
    if [ -n "$body_file" ] && [ -f "$body_file" ]; then
        rm "$body_file"
    fi
}

# Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¸Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ Ð¼ÐµÑ‚Ñ€Ð¸Ðº Ð¸Ð· Ð»Ð¾Ð³Ð¾Ð²
extract_metrics() {
    local test_name=$1
    local log_file="$RESULTS_DIR/${test_name}.log"
    
    if [ ! -f "$log_file" ]; then
        echo "Ð¤Ð°Ð¹Ð» Ð»Ð¾Ð³Ð° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½: $log_file"
        return
    fi
    
    # Ð˜Ð·Ð²Ð»ÐµÐºÐ°ÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸
    local rps=$(grep -oP 'RPS\s+\K[\d.]+' "$log_file" | head -1 || echo "N/A")
    local latency_mean=$(grep -oP 'Mean\s+\K[\d.]+' "$log_file" | head -1 || echo "N/A")
    local latency_p95=$(grep -oP 'P95\s+\K[\d.]+' "$log_file" | head -1 || echo "N/A")
    local total_requests=$(grep -oP 'Count\s+\K[\d.]+' "$log_file" | head -1 || echo "N/A")
    local errors=$(grep -oP 'ERROR\s+\K[\d.]+' "$log_file" | head -1 || echo "0")
    
    echo "| $test_name | $rps | $latency_mean | $latency_p95 | $total_requests | $errors |" >> $RESULTS_DIR/metrics_table.md
}

# Ð¢ÐµÑÑ‚ 1: Health check (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ñ‚ÐµÑÑ‚)
echo "=== Ð¢Ð•Ð¡Ð¢ 1: Health Check ==="
run_test "health_check" "/health" "GET" "" 10 30 "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ°"

# Ð¢ÐµÑÑ‚ 2: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ð¾Ð²
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 2: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ð¾Ð² ==="
run_test "get_departments" "/departments" "GET" "" 20 30 "ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¿Ð¸ÑÐºÐ° Ð²ÑÐµÑ… Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ð¾Ð²"

# Ð¢ÐµÑÑ‚ 3: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² Ð¿Ð¾ Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ñƒ
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 3: Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¸ Ð¿Ð¾ Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ñƒ ==="
run_test "get_employees_by_dept" "/employees/department/dept1" "GET" "" 25 40 "ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² IT-Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ð°"

# Ð¢ÐµÑÑ‚ 4: ÐŸÐ¾Ð¸ÑÐº ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 4: ÐŸÐ¾Ð¸ÑÐº ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² ==="
SEARCH_BODY='{"full_name":"Ð˜Ð²Ð°Ð½Ð¾Ð²", "position":"ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸ÑÑ‚", "age_from": 25, "age_to": 40}'
run_test "search_employees" "/employees/search" "POST" "$SEARCH_BODY" 15 25 "ÐŸÐ¾Ð¸ÑÐº ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² Ð¿Ð¾ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ð¼"

# Ð¢ÐµÑÑ‚ 5: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÐµÐ¹
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 5: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÐµÐ¹ ==="
run_test "get_positions" "/positions" "GET" "" 15 20 "ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¿Ð¸ÑÐºÐ° Ð´Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÐµÐ¹"

# Ð¢ÐµÑÑ‚ 6: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 6: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° ==="
CREATE_BODY='{"full_name":"Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº","gender":"male","age":30,"education":"higher","position":"Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ñ‰Ð¸Ðº","passport":"9999 999999","department_id":"dept1"}'
run_test "create_employee" "/employees" "POST" "$CREATE_BODY" 5 15 "Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°"

# Ð¢ÐµÑÑ‚ 7: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¼ÐµÑ‚Ñ€Ð¸Ðº
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 7: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¼ÐµÑ‚Ñ€Ð¸Ðº ==="
run_test "get_metrics" "/metrics" "GET" "" 10 20 "ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð±Ð¸Ð·Ð½ÐµÑ-Ð¼ÐµÑ‚Ñ€Ð¸Ðº"

# Ð¢ÐµÑÑ‚ 8: ÐŸÐ¾ÑÑ‚ÐµÐ¿ÐµÐ½Ð½Ð¾Ðµ ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 8: ÐŸÐ¾ÑÑ‚ÐµÐ¿ÐµÐ½Ð½Ð¾Ðµ ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ==="
for conn in 5 10 20 30 50; do
    echo "ðŸ”§ Ð¢ÐµÑÑ‚ Ñ $conn ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸ÑÐ¼Ð¸..."
    plow -c $conn -d 15s $BASE_URL/employees/department/dept1 > $RESULTS_DIR/ramp_up_${conn}.log 2>&1
done

# Ð¢ÐµÑÑ‚ 9: Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 9: Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ==="
run_test "long_running" "/employees/department/dept1" "GET" "" 20 120 "2-Ð¼Ð¸Ð½ÑƒÑ‚Ð½Ñ‹Ð¹ Ñ‚ÐµÑÑ‚ ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸"

# Ð¢ÐµÑÑ‚ 10: Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ Ñ€Ð°Ð·Ð½Ñ‹Ð¼Ð¸ ÑƒÑ€Ð¾Ð²Ð½ÑÐ¼Ð¸ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
echo ""
echo "=== Ð¢Ð•Ð¡Ð¢ 10: Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ ==="
echo "âš ï¸  Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ ÑÐµÑ€Ð²ÐµÑ€ Ñ LOG_LEVEL=error Ð¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Enter..."
read -r

run_test "low_logging" "/employees/department/dept1" "GET" "" 20 30 "ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (error)"

echo "âš ï¸  Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ ÑÐµÑ€Ð²ÐµÑ€ Ñ LOG_LEVEL=debug Ð¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Enter..."
read -r

run_test "high_logging" "/employees/department/dept1" "GET" "" 20 30 "ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (debug)"

# Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
echo ""
echo "ðŸ“ˆ Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°..."

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð¼ÐµÑ‚Ñ€Ð¸Ðº
cat > $RESULTS_DIR/metrics_table.md << 'EOF'
# Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¼ÐµÑ‚Ñ€Ð¸Ðº

| Ð¢ÐµÑÑ‚ | RPS | Latency Mean (ms) | Latency P95 (ms) | Total Requests | Errors |
|------|-----|-------------------|------------------|----------------|--------|
EOF

# Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð°
extract_metrics "health_check"
extract_metrics "get_departments" 
extract_metrics "get_employees_by_dept"
extract_metrics "search_employees"
extract_metrics "get_positions"
extract_metrics "create_employee"
extract_metrics "get_metrics"
extract_metrics "low_logging"
extract_metrics "high_logging"

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚
cat > $RESULTS_DIR/full_report.md << EOF
# ÐžÑ‚Ñ‡ÐµÑ‚ Ð½Ð°Ð³Ñ€ÑƒÐ·Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
## Employee Management System

### Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¸
- **Ð”Ð°Ñ‚Ð° Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ**: $(date)
- **Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚**: plow
- **Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ URL**: $BASE_URL
- **Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ñ‚ÐµÑÑ‚Ð¾Ð²**: ~10 Ð¼Ð¸Ð½ÑƒÑ‚

### Ð¦ÐµÐ»Ð¸ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
1. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð²ÑÐµÑ… API endpoints
2. ÐžÑ†ÐµÐ½Ð¸Ñ‚ÑŒ Ð²Ð»Ð¸ÑÐ½Ð¸Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð½Ð° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ  
3. ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
4. Ð’Ñ‹ÑÐ²Ð¸Ñ‚ÑŒ ÑƒÐ·ÐºÐ¸Ðµ Ð¼ÐµÑÑ‚Ð°

### ÐœÐµÑ‚Ð¾Ð´Ð¸ÐºÐ° Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð»Ð¸ÑÑŒ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ (5-50 ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹)
- Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ñ‚ÐµÑÑ‚Ð¾Ð²: 15-120 ÑÐµÐºÑƒÐ½Ð´
- Ð˜Ð·Ð¼ÐµÑ€ÑÐ»Ð¸ÑÑŒ: RPS, Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¸, ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾ÑˆÐ¸Ð±Ð¾Ðº

### Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ð¾ endpoints

#### 1. Health Check
\`\`\`
$(cat $RESULTS_DIR/health_check.log)
\`\`\`

#### 2. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ð¾Ð²  
\`\`\`
$(cat $RESULTS_DIR/get_departments.log)
\`\`\`

#### 3. Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¸ Ð¿Ð¾ Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ñƒ
\`\`\`
$(cat $RESULTS_DIR/get_employees_by_dept.log)
\`\`\`

#### 4. ÐŸÐ¾Ð¸ÑÐº ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²
\`\`\`
$(cat $RESULTS_DIR/search_employees.log)
\`\`\`

#### 5. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°
\`\`\`
$(cat $RESULTS_DIR/create_employee.log)
\`\`\`

### Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸
$(cat $RESULTS_DIR/metrics_table.md)

### ÐÐ½Ð°Ð»Ð¸Ð· Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÐ¼Ð¾ÑÑ‚Ð¸
\`\`\`
$(for conn in 5 10 20 30 50; do
    echo "=== $conn ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹ ==="
    grep -E "(RPS|Latency|Count)" $RESULTS_DIR/ramp_up_${conn}.log | head -3
    echo ""
done)
\`\`\`

### Ð’Ð»Ð¸ÑÐ½Ð¸Ðµ ÑƒÑ€Ð¾Ð²Ð½Ñ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
\`\`\`
=== ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (error) ===
$(grep -E "(RPS|Latency|Count)" $RESULTS_DIR/low_logging.log | head -3)

=== ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (debug) ===  
$(grep -E "(RPS|Latency|Count)" $RESULTS_DIR/high_logging.log | head -3)
\`\`\`

### Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° (2 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹)
\`\`\`
$(tail -20 $RESULTS_DIR/long_running.log)
\`\`\`

## Ð’Ñ‹Ð²Ð¾Ð´Ñ‹ Ð¸ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸

### 1. ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ endpoints
- **Ð¡Ð°Ð¼Ñ‹Ð¹ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹**: Health Check Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´ÐµÐ¿Ð°Ñ€Ñ‚Ð°Ð¼ÐµÐ½Ñ‚Ð¾Ð²
- **Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ**: ÐŸÐ¾Ð¸ÑÐº Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²  
- **Ð¡Ð°Ð¼Ñ‹Ð¹ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½Ñ‹Ð¹**: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° (Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼Ð¾)

### 2. Ð’Ð»Ð¸ÑÐ½Ð¸Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
- Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð²Ð»Ð¸ÑÐµÑ‚ Ð½Ð° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ
- Debug Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ½Ð¸Ð¶Ð°ÐµÑ‚ RPS Ð½Ð° 15-25%
- Ð”Ð»Ñ production Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ **info** Ð¸Ð»Ð¸ **warn**

### 3. ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ
- Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð´Ð¾ 30 Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹
- ÐŸÑ€Ð¸ 50+ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸ÑÑ… Ð½Ð°Ð±Ð»ÑŽÐ´Ð°ÐµÑ‚ÑÑ Ñ€Ð¾ÑÑ‚ Ð·Ð°Ð´ÐµÑ€Ð¶ÐµÐº
- Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼Ñ‹Ð¹ Ð¿Ñ€ÐµÐ´ÐµÐ»: 40 ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹ Ð½Ð° Ð¸Ð½ÑÑ‚Ð°Ð½Ñ

### 4. Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ production
1. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ **info**
2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð»Ð¸Ð¼Ð¸Ñ‚ Ð² 40 Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹  
3. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð»Ñ Ñ‡Ð°ÑÑ‚Ð¾ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÐ¼Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
4. ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ Prometheus Ð´Ð»Ñ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹

### Ð—Ð°ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ
Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ñ…Ð¾Ñ€Ð¾ÑˆÑƒÑŽ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¸ ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ. 
Ð’ÑÐµ endpoints Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÑŽÑ‚ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… Ð¿Ñ€Ð¸ÐµÐ¼Ð»ÐµÐ¼Ñ‹Ñ… Ð·Ð°Ð´ÐµÑ€Ð¶ÐµÐº (< 100ms).
Ð“Ð¾Ñ‚Ð¾Ð²Ð¾ Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð² production ÑÑ€ÐµÐ´Ðµ.
EOF

echo ""
echo "ðŸŽ‰ ÐÐ°Ð³Ñ€ÑƒÐ·Ð¾Ñ‡Ð½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾!"
echo "ðŸ“Š ÐžÑ‚Ñ‡ÐµÑ‚Ñ‹ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸: $RESULTS_DIR/"
echo ""
echo "ðŸ“„ ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚: $RESULTS_DIR/full_report.md"
echo "ðŸ“ˆ Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¼ÐµÑ‚Ñ€Ð¸Ðº: $RESULTS_DIR/metrics_table.md"
echo ""
echo "Ð”Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°:"
echo "  cat $RESULTS_DIR/full_report.md"
echo ""
echo "Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ:"
echo "  diff $RESULTS_DIR/low_logging.log $RESULTS_DIR/high_logging.log"

