<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
    <style>
              body {
            font-family: Arial;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 15px;
        }
        h1 {
            text-align: center;
            margin-bottom: 15px;
        }
        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #ccc;
        }
        .tab {
            padding: 8px 12px;
            cursor: pointer;
            border: 1px solid transparent;
            flex: 1;
            text-align: center;
        }
        .tab.active {
            background: #fff;
            border-color: #ccc;
            border-bottom-color: #fff;
            margin-bottom: -1px;
        }
        select, input {
            padding: 6px;
            margin: 5px 0;
            border: 1px solid #ccc;
            width: 100%;
            box-sizing: border-box;
        }
        .btn {
            padding: 6px 12px;
            margin: 2px;
            cursor: pointer;
            border: 1px solid #ccc;
        }
        .btn-primary {
            background: #0066cc;
            color: white;
        }
        .btn-success {
            background: #28a745;
            color: white;
        }
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        .employee-card {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 8px 0;
        }
        .employee-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .employee-info {
            margin: 8px 0;
        }
        .employee-info div {
            margin: 3px 0;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal {
            background: white;
            padding: 20px;
            width: 90%;
            max-width: 400px;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 8px;
            margin: 5px 0;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 8px;
            margin: 5px 0;
        }
        .form-group {
            margin: 10px 0;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <h1>üë• –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</h1>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            <div v-if="error" class="error">
                {{ error }}
            </div>
            <div v-if="success" class="success">
                {{ success }}
            </div>
            
            <div class="tabs">
                <button class="tab" :class="{ active: activeTab === 'list' }" @click="setActiveTab('list')">
                    üìã –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                </button>
                <button class="tab" :class="{ active: activeTab === 'create' }" @click="setActiveTab('create')">
                    ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                </button>
                <button class="tab" :class="{ active: activeTab === 'search' }" @click="setActiveTab('search')">
                    üîç –ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                </button>
            </div>

            <!-- –í—ã–±–æ—Ä –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ -->
            <div class="department-selector" v-if="activeTab !== 'search'">
                <label>üè¢ –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç:</label>
                <select v-model="selectedDepartmentId" @change="loadEmployees" :disabled="loading">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</option>
                    <option v-for="dept in departments" :key="dept.id" :value="dept.id">
                        {{ dept.name }}
                    </option>
                </select>
                <span v-if="selectedDepartment && employees.length">
                    –°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: <strong>{{ employees.length }}</strong>
                </span>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
            <div v-if="activeTab === 'list'">
                <div v-if="loading" class="loading">
                    ‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...
                </div>
                <div v-else-if="!selectedDepartmentId" class="empty-state">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</h3>
                    <p>–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</p>
                </div>
                <div v-else-if="employees.length === 0" class="empty-state">
                    <h3>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                    <p>–í –≤—ã–±—Ä–∞–Ω–Ω–æ–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–µ –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
                </div>
                <div v-else class="employee-list">
                    <div v-for="employee in employees" :key="employee.id" 
                         class="employee-card" :class="{ fired: employee.status === 'fired' }">
                        <div class="employee-header">
                            <div class="employee-name">{{ employee.full_name }}</div>
                            <div class="employee-status" :class="`status-${employee.status}`">
                                {{ getStatusText(employee.status) }}
                            </div>
                        </div>
                        <div class="employee-info">
                            <div class="info-item">
                                <div class="info-label">–î–æ–ª–∂–Ω–æ—Å—Ç—å</div>
                                <div class="info-value">{{ employee.position }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–ü–æ–ª / –í–æ–∑—Ä–∞—Å—Ç</div>
                                <div class="info-value">{{ employee.gender === 'male' ? '–ú' : '–ñ' }} / {{ employee.age }} –ª–µ—Ç</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</div>
                                <div class="info-value">{{ getEducationText(employee.education) }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–ü–∞—Å–ø–æ—Ä—Ç</div>
                                <div class="info-value">{{ employee.passport }}</div>
                            </div>
                        </div>
                        <div class="employee-actions">
                            <button class="btn btn-primary" @click="editEmployee(employee)" 
                                    v-if="employee.status !== 'fired'" :disabled="loading">
                                ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button class="btn btn-success" @click="changeStatus(employee.id, 'vacation')" 
                                    v-if="employee.status === 'active'" :disabled="loading">
                                üèùÔ∏è –í –æ—Ç–ø—É—Å–∫
                            </button>
                            <button class="btn btn-success" @click="changeStatus(employee.id, 'active')" 
                                    v-if="employee.status === 'vacation'" :disabled="loading">
                                üíº –í–µ—Ä–Ω—É—Ç—å
                            </button>
                            <button class="btn btn-danger" @click="changeStatus(employee.id, 'fired')" 
                                    v-if="employee.status !== 'fired'" :disabled="loading">
                                üö™ –£–≤–æ–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
            <div v-if="activeTab === 'create'">
                <div v-if="!selectedDepartmentId" class="empty-state">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</h3>
                    <p>–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</p>
                </div>
                <form v-else @submit.prevent="createEmployee">
                    <div class="form-row">
                        <div class="form-group">
                            <label>üë§ –§–ò–û *</label>
                            <input type="text" v-model="newEmployee.full_name" required 
                                   placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" :disabled="loading">
                        </div>
                        <div class="form-group">
                            <label>‚ö§ –ü–æ–ª *</label>
                            <select v-model="newEmployee.gender" required :disabled="loading">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                                <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                                <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>üéÇ –í–æ–∑—Ä–∞—Å—Ç *</label>
                            <input type="number" v-model.number="newEmployee.age" required 
                                   min="18" max="70" placeholder="30" :disabled="loading">
                        </div>
                        <div class="form-group">
                            <label>üéì –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ *</label>
                            <select v-model="newEmployee.education" required :disabled="loading">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                                <option value="secondary">–°—Ä–µ–¥–Ω–µ–µ</option>
                                <option value="specialized">–°—Ä–µ–¥–Ω–µ-—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ</option>
                                <option value="higher">–í—ã—Å—à–µ–µ</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>üíº –î–æ–ª–∂–Ω–æ—Å—Ç—å *</label>
                        <select v-model="newEmployee.position" required :disabled="loading">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å</option>
                            <option v-for="position in positions" :key="position" :value="position">
                                {{ position }}
                            </option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>üìÑ –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ *</label>
                        <input type="text" v-model="newEmployee.passport" required 
                               placeholder="1234 567890" 
                               pattern="\d{4} \d{6}"
                               title="–§–æ—Ä–º–∞—Ç: 1234 567890" :disabled="loading">
                    </div>
                    
                    <button type="submit" class="btn btn-success" :disabled="loading">
                        {{ loading ? '‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ...' : '‚ú® –°–æ–∑–¥–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞' }}
                    </button>
                </form>
            </div>

            <!-- –ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
            <div v-if="activeTab === 'search'">
                <div class="search-filters">
                    <h3 style="margin-bottom: 20px;">üîç –§–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</h3>
                    <div class="filters-row">
                        <div class="form-group">
                            <label>–§–ò–û</label>
                            <input type="text" v-model="searchFilters.full_name" 
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ –§–ò–û" :disabled="loading">
                        </div>
                        <div class="form-group">
                            <label>–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
                            <select v-model="searchFilters.position" :disabled="loading">
                                <option value="">–í—Å–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏</option>
                                <option v-for="position in positions" :key="position" :value="position">
                                    {{ position }}
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–ü–æ–ª</label>
                            <select v-model="searchFilters.gender" :disabled="loading">
                                <option value="">–õ—é–±–æ–π</option>
                                <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                                <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</label>
                            <select v-model="searchFilters.education" :disabled="loading">
                                <option value="">–õ—é–±–æ–µ</option>
                                <option value="secondary">–°—Ä–µ–¥–Ω–µ–µ</option>
                                <option value="specialized">–°—Ä–µ–¥–Ω–µ-—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ</option>
                                <option value="higher">–í—ã—Å—à–µ–µ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–í–æ–∑—Ä–∞—Å—Ç –æ—Ç</label>
                            <input type="number" v-model.number="searchFilters.age_from" 
                                   min="18" max="70" placeholder="18" :disabled="loading">
                        </div>
                        <div class="form-group">
                            <label>–í–æ–∑—Ä–∞—Å—Ç –¥–æ</label>
                            <input type="number" v-model.number="searchFilters.age_to" 
                                   min="18" max="70" placeholder="70" :disabled="loading">
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" @click="searchEmployees" :disabled="loading">
                                {{ loading ? '‚è≥ –ü–æ–∏—Å–∫...' : 'üîç –ü–æ–∏—Å–∫' }}
                            </button>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-secondary" @click="clearFilters" :disabled="loading">
                                üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>

                <div v-if="loading" class="loading">
                    ‚è≥ –ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...
                </div>
                <div v-else-if="searchResults.length === 0 && hasSearched" class="empty-state">
                    <h3>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
                </div>
                <div v-else-if="searchResults.length > 0" class="employee-list">
                    <div v-for="employee in searchResults" :key="employee.id" 
                         class="employee-card" :class="{ fired: employee.status === 'fired' }">
                        <div class="employee-header">
                            <div class="employee-name">{{ employee.full_name }}</div>
                            <div class="employee-status" :class="`status-${employee.status}`">
                                {{ getStatusText(employee.status) }}
                            </div>
                        </div>
                        <div class="employee-info">
                            <div class="info-item">
                                <div class="info-label">–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</div>
                                <div class="info-value">{{ getDepartmentName(employee.department_id) }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–î–æ–ª–∂–Ω–æ—Å—Ç—å</div>
                                <div class="info-value">{{ employee.position }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–ü–æ–ª / –í–æ–∑—Ä–∞—Å—Ç</div>
                                <div class="info-value">{{ employee.gender === 'male' ? '–ú' : '–ñ' }} / {{ employee.age }} –ª–µ—Ç</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</div>
                                <div class="info-value">{{ getEducationText(employee.education) }}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–ü–∞—Å–ø–æ—Ä—Ç</div>
                                <div class="info-value">{{ employee.passport }}</div>
                            </div>
                        </div>
                        <div class="employee-actions">
                            <button class="btn btn-primary" @click="editEmployee(employee)" 
                                    v-if="employee.status !== 'fired'" :disabled="loading">
                                ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button class="btn btn-success" @click="changeStatus(employee.id, 'vacation')" 
                                    v-if="employee.status === 'active'" :disabled="loading">
                                üèùÔ∏è –í –æ—Ç–ø—É—Å–∫
                            </button>
                            <button class="btn btn-success" @click="changeStatus(employee.id, 'active')" 
                                    v-if="employee.status === 'vacation'" :disabled="loading">
                                üíº –í–µ—Ä–Ω—É—Ç—å
                            </button>
                            <button class="btn btn-danger" @click="changeStatus(employee.id, 'fired')" 
                                    v-if="employee.status !== 'fired'" :disabled="loading">
                                üö™ –£–≤–æ–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
                <div v-else class="empty-state">
                    <h3>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</h3>
                    <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–∏—Å–∫"</p>
                </div>
            </div>

            <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div v-if="showEditModal" class="modal-overlay" @click="closeEditModal">
                <div class="modal" @click.stop>
                    <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
                    <form @submit.prevent="saveEmployee">
                        <div class="form-row">
                            <div class="form-group">
                                <label>üë§ –§–ò–û *</label>
                                <input type="text" v-model="editingEmployee.full_name" required :disabled="loading">
                            </div>
                            <div class="form-group">
                                <label>‚ö§ –ü–æ–ª *</label>
                                <select v-model="editingEmployee.gender" required :disabled="loading">
                                    <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                                    <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>üéÇ –í–æ–∑—Ä–∞—Å—Ç *</label>
                                <input type="number" v-model.number="editingEmployee.age" required min="18" max="70" :disabled="loading">
                            </div>
                            <div class="form-group">
                                <label>üéì –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ *</label>
                                <select v-model="editingEmployee.education" required :disabled="loading">
                                    <option value="secondary">–°—Ä–µ–¥–Ω–µ–µ</option>
                                    <option value="specialized">–°—Ä–µ–¥–Ω–µ-—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ</option>
                                    <option value="higher">–í—ã—Å—à–µ–µ</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>üíº –î–æ–ª–∂–Ω–æ—Å—Ç—å *</label>
                            <select v-model="editingEmployee.position" required :disabled="loading">
                                <option v-for="position in positions" :key="position" :value="position">
                                    {{ position }}
                                </option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>üìÑ –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ *</label>
                            <input type="text" v-model="editingEmployee.passport" required 
                                   pattern="\d{4} \d{6}" title="–§–æ—Ä–º–∞—Ç: 1234 567890" :disabled="loading">
                        </div>
                        
                        <div style="display: flex; gap: 15px; margin-top: 25px;">
                            <button type="submit" class="btn btn-success" :disabled="loading">
                                {{ loading ? '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å' }}
                            </button>
                            <button type="button" class="btn btn-secondary" @click="closeEditModal" :disabled="loading">
                                ‚ùå –û—Ç–º–µ–Ω–∞
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        createApp({
            setup() {
                // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                const activeTab = ref('list');
                const selectedDepartmentId = ref('');
                const showEditModal = ref(false);
                const editingEmployee = ref(null);
                const loading = ref(false);
                const error = ref('');
                const success = ref('');
                const hasSearched = ref(false);
                
                // –î–∞–Ω–Ω—ã–µ
                const departments = ref([]);
                const positions = ref([]);
                const employees = ref([]);
                const searchResults = ref([]);
                
                // –§–æ—Ä–º—ã
                const newEmployee = ref({
                    full_name: '',
                    gender: '',
                    age: '',
                    education: '',
                    position: '',
                    passport: '',
                    department_id: ''
                });

                const searchFilters = ref({
                    full_name: '',
                    position: '',
                    gender: '',
                    education: '',
                    age_from: '',
                    age_to: ''
                });

                // API —Ñ—É–Ω–∫—Ü–∏–∏
                const api = {
                    async request(url, options = {}) {
                        try {
                            const response = await fetch(`/api${url}`, {
                                headers: {
                                    'Content-Type': 'application/json',
                                    ...options.headers,
                                },
                                ...options,
                            });
                            
                            const data = await response.json();
                            
                            if (!response.ok) {
                                throw new Error(data.error || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                            }
                            
                            return data;
                        } catch (err) {
                            throw new Error(err.message || '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
                        }
                    },

                    async get(url) {
                        return this.request(url);
                    },

                    async post(url, data) {
                        return this.request(url, {
                            method: 'POST',
                            body: JSON.stringify(data),
                        });
                    },

                    async put(url, data) {
                        return this.request(url, {
                            method: 'PUT',
                            body: JSON.stringify(data),
                        });
                    },

                    async patch(url, data) {
                        return this.request(url, {
                            method: 'PATCH',
                            body: JSON.stringify(data),
                        });
                    }
                };

                // –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
                const selectedDepartment = computed(() => {
                    return departments.value.find(d => d.id === selectedDepartmentId.value);
                });

                // –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                const showError = (message) => {
                    error.value = message;
                    success.value = '';
                    setTimeout(() => { error.value = ''; }, 5000);
                };

                const showSuccess = (message) => {
                    success.value = message;
                    error.value = '';
                    setTimeout(() => { success.value = ''; }, 3000);
                };

                // –ú–µ—Ç–æ–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                const loadDepartments = async () => {
                    try {
                        const result = await api.get('/departments');
                        departments.value = result.data;
                    } catch (err) {
                        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤: ' + err.message);
                    }
                };

                const loadPositions = async () => {
                    try {
                        const result = await api.get('/positions');
                        positions.value = result.data;
                    } catch (err) {
                        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π: ' + err.message);
                    }
                };

                const loadEmployees = async () => {
                    if (!selectedDepartmentId.value) {
                        employees.value = [];
                        return;
                    }

                    loading.value = true;
                    try {
                        const result = await api.get(`/employees/department/${selectedDepartmentId.value}`);
                        employees.value = result.data;
                    } catch (err) {
                        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: ' + err.message);
                        employees.value = [];
                    } finally {
                        loading.value = false;
                    }
                };

                // –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏
                const createEmployee = async () => {
                    loading.value = true;
                    try {
                        newEmployee.value.department_id = selectedDepartmentId.value;
                        
                        const result = await api.post('/employees', newEmployee.value);
                        
                        if (result.success) {
                            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
                            newEmployee.value = {
                                full_name: '',
                                gender: '',
                                age: '',
                                education: '',
                                position: '',
                                passport: '',
                                department_id: ''
                            };
                            
                            showSuccess(result.message || '‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
                            await loadEmployees();
                            activeTab.value = 'list';
                        }
                    } catch (err) {
                        showError('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: ' + err.message);
                    } finally {
                        loading.value = false;
                    }
                };

                const editEmployee = (employee) => {
                    editingEmployee.value = { ...employee };
                    showEditModal.value = true;
                };

                const saveEmployee = async () => {
                    loading.value = true;
                    try {
                        const result = await api.put(`/employees/${editingEmployee.value.id}`, editingEmployee.value);
                        
                        if (result.success) {
                            closeEditModal();
                            showSuccess(result.message || '‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
                            await loadEmployees();
                            if (activeTab.value === 'search' && hasSearched.value) {
                                await searchEmployees();
                            }
                        }
                    } catch (err) {
                        showError('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: ' + err.message);
                    } finally {
                        loading.value = false;
                    }
                };

                const closeEditModal = () => {
                    showEditModal.value = false;
                    editingEmployee.value = null;
                };

                const changeStatus = async (employeeId, newStatus) => {
                    const statusTexts = {
                        vacation: '–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –æ—Ç–ø—É—Å–∫',
                        active: '–≤–µ—Ä–Ω—É—Ç—å –∏–∑ –æ—Ç–ø—É—Å–∫–∞',
                        fired: '—É–≤–æ–ª–∏—Ç—å'
                    };

                    if (confirm(`–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ${statusTexts[newStatus]}?`)) {
                        loading.value = true;
                        try {
                            const result = await api.patch(`/employees/${employeeId}/status`, { status: newStatus });
                            
                            if (result.success) {
                                const statusMessages = {
                                    vacation: 'üèùÔ∏è –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –æ—Ç–ø—É—Å–∫',
                                    active: 'üíº –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –≤–µ—Ä–Ω—É–ª—Å—è –∏–∑ –æ—Ç–ø—É—Å–∫–∞',
                                    fired: 'üö™ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ —É–≤–æ–ª–µ–Ω'
                                };
                                
                                showSuccess(result.message || statusMessages[newStatus]);
                                await loadEmployees();
                                if (activeTab.value === 'search' && hasSearched.value) {
                                    await searchEmployees();
                                }
                            }
                        } catch (err) {
                            showError('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞: ' + err.message);
                        } finally {
                            loading.value = false;
                        }
                    }
                };

                const searchEmployees = async () => {
                    loading.value = true;
                    hasSearched.value = true;
                    try {
                        const result = await api.post('/employees/search', searchFilters.value);
                        searchResults.value = result.data;
                    } catch (err) {
                        showError('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: ' + err.message);
                        searchResults.value = [];
                    } finally {
                        loading.value = false;
                    }
                };

                const clearFilters = () => {
                    searchFilters.value = {
                        full_name: '',
                        position: '',
                        gender: '',
                        education: '',
                        age_from: '',
                        age_to: ''
                    };
                    searchResults.value = [];
                    hasSearched.value = false;
                };

                // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
                const setActiveTab = (tab) => {
                    activeTab.value = tab;
                    error.value = '';
                    success.value = '';
                };

                const getStatusText = (status) => {
                    const statusMap = {
                        active: '–ê–∫—Ç–∏–≤–µ–Ω',
                        vacation: '–í –æ—Ç–ø—É—Å–∫–µ',
                        fired: '–£–≤–æ–ª–µ–Ω'
                    };
                    return statusMap[status] || status;
                };

                const getEducationText = (education) => {
                    const educationMap = {
                        secondary: '–°—Ä–µ–¥–Ω–µ–µ',
                        specialized: '–°—Ä–µ–¥–Ω–µ-—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ',
                        higher: '–í—ã—Å—à–µ–µ'
                    };
                    return educationMap[education] || education;
                };

                const getDepartmentName = (departmentId) => {
                    const dept = departments.value.find(d => d.id === departmentId);
                    return dept ? dept.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç';
                };

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                onMounted(async () => {
                    await loadDepartments();
                    await loadPositions();
                });

                return {
                    // –°–æ—Å—Ç–æ—è–Ω–∏–µ
                    activeTab,
                    selectedDepartmentId,
                    showEditModal,
                    editingEmployee,
                    loading,
                    error,
                    success,
                    hasSearched,
                    
                    // –î–∞–Ω–Ω—ã–µ
                    departments,
                    positions,
                    employees,
                    searchResults,
                    newEmployee,
                    searchFilters,
                    
                    // –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
                    selectedDepartment,
                    
                    // –ú–µ—Ç–æ–¥—ã
                    setActiveTab,
                    loadEmployees,
                    createEmployee,
                    editEmployee,
                    saveEmployee,
                    closeEditModal,
                    changeStatus,
                    searchEmployees,
                    clearFilters,
                    getStatusText,
                    getEducationText,
                    getDepartmentName
                };
            }
        }).mount('#app');
    </script>
</body>
</html>

